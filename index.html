<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>6-Minute Walk Test</title>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 16px;
      background: #f5f5f5;
      line-height: 1.4;
    }

    .app {
      max-width: 560px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 16px 16px 24px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
      margin: 0;
      font-size: 22px;
      font-weight: 700;
    }

    .subtitle {
      text-align: center;
      font-size: 12px;
      color: #777;
      margin-bottom: 12px;
    }

    .section-title {
      margin-top: 18px;
      margin-bottom: 6px;
      font-size: 14px;
      font-weight: 600;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 6px;
      font-size: 12px;
    }

    .info-grid label {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    input {
      width: 100%;
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 12px;
      box-sizing: border-box;
      text-align: center;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 11px;
      margin-bottom: 10px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 5px;
      text-align: center;
    }

    th {
      background: #fafafa;
      font-weight: 600;
    }

    .timer-display {
      font-size: 40px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 10px;
    }

    .btn-row {
      text-align: center;
      margin-bottom: 6px;
    }

    button {
      padding: 8px 14px;
      border: none;
      border-radius: 999px;
      margin: 0 4px;
      color: #fff;
      min-width: 80px;
      font-size: 14px;
    }

    .btn-start { background: #4caf50; }
    .btn-pause { background: #ff9800; }
    .btn-reset { background: #f44336; }
    .btn-lap   { background: #2196f3; }

    .active-minute {
      background: #e3f2fd !important;
    }
  </style>
</head>
<body>

<div class="app">

  <h1>6-Minute Walk Test</h1>
  <div class="subtitle">Trial 1 & Trial 2 · Mobile Optimized</div>

  <!-- Patient Info -->
  <div class="section-title">Patient Info</div>
  <div class="info-grid">
    <label>Name<input type="text"></label>
    <label>NRIC<input type="text"></label>
    <label>DOB<input type="date"></label>
    <label>Race<input type="text"></label>
    <label>Sex<input type="text"></label>
  </div>

  <!-- Height Weight BMI -->
  <div class="section-title">Body Measurements</div>
  <div class="info-grid">
    <label>Height (cm)<input type="number"></label>
    <label>Weight (kg)<input type="number"></label>
    <label>BMI<input type="number" step="0.1"></label>
  </div>

  <!-- Timer -->
  <div class="section-title">Timer</div>
  <div id="timer" class="timer-display">00:00</div>
  <div class="btn-row">
    <button id="startBtn" class="btn-start">Start</button>
    <button id="pauseBtn" class="btn-pause">Pause</button>
    <button id="resetBtn" class="btn-reset">Reset</button>
  </div>
  <div class="btn-row">
    <button id="lapBtn" class="btn-lap">Lap 30m</button>
  </div>

  <!-- At Rest -->
  <div class="section-title">At Rest</div>
  <table>
    <thead>
      <tr>
        <th>SpO₂</th>
        <th>PR</th>
        <th>BP</th>
        <th>Borg</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input></td>
        <td><input></td>
        <td><input placeholder="120/80"></td>
        <td><input></td>
      </tr>
    </tbody>
  </table>

  <!-- Exercise -->
  <div class="section-title">Exercise (Minute 1–6)</div>
  <table>
    <thead>
      <tr>
        <th rowspan="2">Min</th>
        <th colspan="3">Trial 1</th>
        <th colspan="3">Trial 2</th>
      </tr>
      <tr>
        <th>SpO₂</th><th>PR</th><th>Borg</th>
        <th>SpO₂</th><th>PR</th><th>Borg</th>
      </tr>
    </thead>

    <tbody id="exerciseBody">
      <tr data-minute="1">
        <td>1</td>
        <td><input></td><td><input></td><td><input></td>
        <td><input></td><td><input></td><td><input></td>
      </tr>
      <tr data-minute="2">
        <td>2</td>
        <td><input></td><td><input></td><td><input></td>
        <td><input></td><td><input></td><td><input></td>
      </tr>
      <tr data-minute="3">
        <td>3</td>
        <td><input></td><td><input></td><td><input></td>
        <td><input></td><td><input></td><td><input></td>
      </tr>
      <tr data-minute="4">
        <td>4</td>
        <td><input></td><td><input></td><td><input></td>
        <td><input></td><td><input></td><td><input></td>
      </tr>
      <tr data-minute="5">
        <td>5</td>
        <td><input></td><td><input></td><td><input></td>
        <td><input></td><td><input></td><td><input></td>
      </tr>
      <tr data-minute="6">
        <td>6</td>
        <td><input></td><td><input></td><td><input></td>
        <td><input></td><td><input></td><td><input></td>
      </tr>
    </tbody>
  </table>

  <!-- Recovery -->
  <div class="section-title">Recovery</div>
  <table>
    <thead>
      <tr>
        <th>SpO₂</th>
        <th>PR</th>
        <th>BP</th>
        <th>Borg</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input></td>
        <td><input></td>
        <td><input placeholder="120/80"></td>
        <td><input></td>
      </tr>
    </tbody>
  </table>

  <!-- Total distance -->
  <div class="section-title">Total Distance</div>
  <table>
    <thead>
      <tr>
        <th></th>
        <th>Trial 1 (m)</th>
        <th>Trial 2 (m)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Total</td>
        <td><input></td>
        <td><input></td>
      </tr>
    </tbody>
  </table>

  <!-- Lap summary -->
  <div id="lapInfo" style="
      text-align:center;
      margin-top:4px;
      font-size:13px;
      font-weight:600;">
    Laps: 0  ·  Distance: 0 m  (30 m per lap)
  </div>

</div>

<script>
  const DURATION = 6 * 60;
  let elapsed = 0;
  let running = false;
  let timerId = null;

  let laps = 0; 

  const timerEl = document.getElementById("timer");
  const exerciseBody = document.getElementById("exerciseBody");
  const lapInfoEl = document.getElementById("lapInfo");
  const lapBtn = document.getElementById("lapBtn");

  function format(sec) {
    const m = String(Math.floor(sec / 60)).padStart(2,'0');
    const s = String(sec % 60).padStart(2,'0');
    return `${m}:${s}`;
  }

  function updateTimer() {
    timerEl.textContent = format(elapsed);
  }

  function highlight() {
    exerciseBody.querySelectorAll("tr").forEach(r =>
      r.classList.remove("active-minute")
    );

    if (elapsed === 0) return;
    let minute = Math.floor((elapsed - 1) / 60) + 1;
    if (minute > 6) minute = 6;

    const row = exerciseBody.querySelector(`tr[data-minute="${minute}"]`);
    if (row) row.classList.add("active-minute");
  }

  function updateLapDisplay() {
    const dist = laps * 30;
    lapInfoEl.textContent = `Laps: ${laps}  ·  Distance: ${dist} m  (30 m per lap)`;
  }

  function startTimer(){
    if (running || elapsed >= DURATION) return;
    running = true;

    timerId = setInterval(()=>{
      elapsed++;
      if (elapsed >= DURATION) elapsed = DURATION;

      updateTimer();
      highlight();

      if (elapsed >= DURATION){
        clearInterval(timerId);
        running = false;
        alert("6 end");
      }
    },1000);
  }

  function pauseTimer(){
    running = false;
    clearInterval(timerId);
  }

  function resetTimer(){
    running = false;
    clearInterval(timerId);
    elapsed = 0;
    updateTimer();
    exerciseBody.querySelectorAll("tr").forEach(r =>
      r.classList.remove("active-minute")
    );
    laps = 0;
    updateLapDisplay();
  }

  document.getElementById("startBtn").onclick = startTimer;
  document.getElementById("pauseBtn").onclick = pauseTimer;
  document.getElementById("resetBtn").onclick = resetTimer;

  lapBtn.onclick = function () {
    laps++;
    updateLapDisplay();
  };

  updateTimer();
  updateLapDisplay();
</script>

</body>
</html>
